<form #myForm="ngForm">
    <p-accordionTab [selected]="true">
        <p-header class="w-100">
            <div class="acc-tab">
                <span>Occupancy details</span>
                <div>
                    <button *ngIf="mode=='view'" pButton type="button" label="Edit" class="btn-primary"
                        (click)="$event.stopPropagation();edit()"
                        [disabled]="(admissionid==null || admissionid==undefined)"></button>
                    <button *ngIf="mode=='add' || mode=='edit'" pButton type="button" label="Save" class="btn-primary"
                        (click)="$event.stopPropagation();save()"></button>
                    <button *ngIf="mode=='add' || mode=='edit'" pButton type="button" label="Cancel" class="btn-secondary ml-2"
                        (click)="$event.stopPropagation();close()"></button>
                </div>
            </div>
        </p-header>
        <div class="mt25">
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label"><span class="required">*</span> Admission Date</label>
                    <div *ngIf="mode=='add' || mode=='edit'">
                        <p-calendar [required]="true" [minDate]="today"
                            [(ngModel)]="ResidentMaster.LastAdmissionDate"
                            [ngModelOptions]="{standalone: true}" [showIcon]="true" inputId="icon"
                            [showTime]="true" [dateFormat]="customDateFormat.CalendarFormat" #admissiondateref="ngModel"
                            class="iconcal"></p-calendar> 
                            <div class="col-md-auto errorMessage pt-2"
                            *ngIf="admissiondateref.errors &&(admissiondateref.touched || admissiondateref.dirty)">
                            <div>Admission date time is required.</div>
                        </div>
                    </div>
                    <div class="my-2 bold" *ngIf="mode=='view'">{{ResidentMaster.LastAdmissionDate |
                        date:customDateFormat.DEF_DATE_TIME}}</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label"><span class="required">*</span> Status</label>
                    <div *ngIf="mode=='add' || mode=='edit'">
                        <p-dropdown [required]="true" name="ddlStatus" [options]="stlstadmissionstatus" [(ngModel)]="ResidentMaster.AdmissionStatus"
                         optionLabel="name" optionValue="code" [filter]="true" placeholder=" "
                            [style]="{width: '100%'}" #statusref="ngModel">
                        </p-dropdown>
                        <!-- <p-selectButton [required]="true"  [options]="stlstadmissionstatus" [(ngModel)]="ResidentMaster.admissionstatus"
                            optionLabel="name" optionValue="code" name="Status" #statusref="ngModel"></p-selectButton> -->
                        <div class="col-md-auto errorMessage pt-2"
                            *ngIf="statusref.errors &&(statusref.touched || statusref.dirty)">
                            <div>Status is required.</div>
                        </div>
                    </div>
                    <div class="my-2 bold" *ngIf="mode=='view'">{{admissionStatus[ResidentMaster.AdmissionStatus]}}</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label class="form-label"><span class="required">*</span> Residency</label>
                    <div *ngIf="mode=='add' || mode=='edit'">
                        <div class="fordesk">
                        <p-selectButton [required]="true"  [options]="stlstresidency" [(ngModel)]="ResidentMaster.Residency"
                            optionLabel="name" optionValue="code" name="Residency" #residencyref="ngModel"></p-selectButton>
                        </div>
                        <div class="formobile">
                        <p-dropdown [required]="true"  [options]="stlstresidency" [(ngModel)]="ResidentMaster.Residency"
                            optionLabel="name" optionValue="code" name="Residency" #residencyref="ngModel"></p-dropdown>
                        </div>
                            <div class="col-md-auto errorMessage pt-2"
                            *ngIf="residencyref.errors &&(residencyref.touched || residencyref.dirty)">
                            <div>Residency is required.</div>
                        </div>
                    </div>
                    <div class="my-2 bold" *ngIf="mode=='view'">{{ResidentMaster.Residency}}</div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label"><span class="required">*</span> Facility</label>
                    <div *ngIf="mode=='add' || mode=='edit'">
                        <p-dropdown [required]="true" name="ddlHome" [options]="lstHomeMaster" [(ngModel)]="ResidentMaster.HomeMasterId"
                        (onChange)="onChangeFacility()" optionLabel="HomeName" optionValue="HomeMasterId" [filter]="true" placeholder="Choose facilty"
                            [style]="{width: '100%'}" #homeref="ngModel">
                        </p-dropdown>
                        <div class="col-md-auto errorMessage pt-2"
                            *ngIf="homeref.errors &&(homeref.touched || homeref.dirty)">
                            <div>Facility is required.</div>
                        </div>
                    </div>
                    <div class="my-2 bold" *ngIf="mode=='view'">{{ResidentMaster.HomeName}}</div>
                </div>
            </div>
                <div class="row">
                    <div class="col-md-6">
                        <label class="form-label"><span class="required">*</span> Location</label>
                        <div *ngIf="mode=='add' || mode=='edit'">
                            <p-dropdown [required]="true" name="ddlLocation" [options]="lstLocationMaster" [(ngModel)]="ResidentMaster.LocationMasterId"
                                optionLabel="LocationName" optionValue="LocationMasterId" [filter]="true" placeholder="Choose location"
                                [style]="{width: '100%'}" #locationref="ngModel">
                            </p-dropdown>
                        </div>
                        <div class="my-2 bold" *ngIf="mode=='view'">{{ResidentMaster.LocationName}}</div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <label class="form-label">Medication trolly</label>
                        <div *ngIf="mode=='add' || mode=='edit'">
                            <p-dropdown name="ddlMedication" [options]="stlstmedication" [(ngModel)]="ResidentMaster.MedicationTrolly"
                            optionLabel="name" optionValue="code" [filter]="true" placeholder="Choose medication trolly"
                            [style]="{width: '100%'}" #medicationref="ngModel">
                        </p-dropdown>
                        </div>
                        <div class="my-2 bold" *ngIf="mode=='view'">{{ResidentMaster.MedicationTrolly}}</div>
                    </div>
                </div>            
        </div>
    </p-accordionTab>
</form>